{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Intro","text":"<p>Comparison Frame is designed to automate and streamline the process of comparing textual data, particularly focusing on various metrics such as character and word count, punctuation usage, and semantic similarity. It's particularly useful for scenarios where consistent text analysis is required, such as evaluating the performance of natural language processing models, monitoring content quality, or tracking changes in textual data over time using manual evaluation.</p>"},{"location":"#installation","title":"Installation","text":"<pre><code>pip install comparisonframe\n</code></pre>"},{"location":"flow/","title":"Flow","text":""},{"location":"release-notes/","title":"Release notes","text":""},{"location":"release-notes/#002","title":"0.0.2","text":"<pre><code>- revised version implemeted based on diagram\n\n- test status based on pandas query for aggregate scores table\n\n- calculating comparison and aggr scores\n\n- metadata for records and runs\n\n- aggregate scores for each query\n\n- recording runs, and comparing them to records though mocker\n\n- separate expandable records analyser\n</code></pre>"},{"location":"release-notes/#001","title":"0.0.1","text":"<pre><code>- adding mocker-db instead of embedder\n</code></pre>"},{"location":"release-notes/#000","title":"0.0.0","text":"<pre><code>- initial version\n</code></pre>"},{"location":"usage-examples/","title":"Usage examples","text":"<pre><code># import sys\n# sys.path.append('../')\nfrom comparisonframe import ComparisonFrame\n</code></pre>"},{"location":"usage-examples/#usage-examples","title":"Usage examples","text":"<p>The examples contain:  1. Creating validation set and saving it to be reused 2. Comparing newly generated data with expected results  3. Calculating aggregate comparison scores 4. Recording test statuses 5. Reseting statuses, flushing records and comparison results</p>"},{"location":"usage-examples/#1-creating-validation-set","title":"1. Creating validation set","text":""},{"location":"usage-examples/#11-initialize-comparison-class","title":"1.1 Initialize comparison class","text":"<pre><code>comparer = ComparisonFrame(\n    # optionally\n    ## mocker default parameters\n    mocker_params = {\n        'file_path' : \"./comparisonframe_storage\",\n         'persist' : True},\n\n    ## scores to calculate\n    compare_scores = ['word_count_diff','semantic_similarity'],\n    aggr_scores = ['median']\n)\n</code></pre> <pre><code>/home/kyriosskia/miniconda3/envs/testenv/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n  warnings.warn(\n</code></pre>"},{"location":"usage-examples/#12-recording-queries-and-expected-responses-validation-set","title":"1.2 Recording queries and expected responses (validation set)","text":"<pre><code>comparer.record_queries(\n    queries = [\"Black metal\", \n               \"Tribulation\"],\n    expected_texts = [\"Black metal is an extreme subgenre of heavy metal music.\",\n    \"Tribulation are a Swedish heavy metal band from Arvika that formed in 2005.\"],\n    metadata = {'name' : 'metal_bands'})\n</code></pre>"},{"location":"usage-examples/#2-comparing-newly-generated-data-with-expected-results","title":"2. Comparing newly generated data with expected results","text":""},{"location":"usage-examples/#21-initialize-new-comparison-class","title":"2.1 Initialize new comparison class","text":"<pre><code>comparer = ComparisonFrame(\n    # optionally\n    ## mocker default parameters\n    mocker_params = {\n        'file_path' : \"./comparisonframe_storage\",\n         'persist' : True},\n\n    ## scores to calculate\n    compare_scores = ['word_count_diff','semantic_similarity'],\n    aggr_scores = ['median']\n)\n</code></pre>"},{"location":"usage-examples/#22-show-validation-set","title":"2.2 Show validation set","text":"<pre><code>untested_queries = comparer.get_all_queries(\n    ## optional\n    metadata_filters={'name' : 'metal_bands'})\nprint(untested_queries)\n</code></pre> <pre><code>['Black metal', 'Tribulation']\n</code></pre> <pre><code>comparer.get_all_records()\n</code></pre> <pre><code>[{'query': 'Black metal',\n  'record_id': '0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8bd7b663c92f2f16e87',\n  'expected_text': 'Black metal is an extreme subgenre of heavy metal music.'},\n {'query': 'Tribulation',\n  'record_id': 'eecd9c2a5b25ee6053891b894157fa30372ed694763385e1ada1dc9ad8e41625',\n  'expected_text': 'Tribulation are a Swedish heavy metal band from Arvika that formed in 2005.'}]\n</code></pre> <pre><code>comparer.get_all_records_df()\n</code></pre> query record_id expected_text 0 Black metal 0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8... Black metal is an extreme subgenre of heavy me... 1 Tribulation eecd9c2a5b25ee6053891b894157fa30372ed694763385... Tribulation are a Swedish heavy metal band fro..."},{"location":"usage-examples/#23-insert-newly-generated-with-records","title":"2.3 Insert newly generated with records","text":"<pre><code>valid_answer_query_1 = \"Black metal is an extreme subgenre of heavy metal music.\"\nvery_similar_answer_query_1 = \"Black metal is a subgenre of heavy metal music.\"\nunexpected_answer_query_1 = \"Black metals are beautiful and are often used in jewelry design.\"\n</code></pre> <pre><code>comparer.record_runs(queries = [\"Black metal\"],\n                     provided_texts = [valid_answer_query_1,\n                                      very_similar_answer_query_1,\n                                      unexpected_answer_query_1],\n                    metadata={'desc' : 'definitions'})\n</code></pre> <pre><code>comparer.get_all_runs()\n</code></pre> <pre><code>[{'timestamp': '2024-08-22 21:27:45',\n  'query': 'Black metal',\n  'run_id': '1831f4f4b65bc287d27ff3bdc7bcbb5d9032b2d6b28602c202514a756eca3223',\n  'provided_text': 'Black metal is an extreme subgenre of heavy metal music.'},\n {'timestamp': '2024-08-22 21:27:45',\n  'query': 'Black metal',\n  'run_id': 'dad65ebf45d7f54284f478e1850d258b8aabb66ba60ff31236666a4ede5260cc',\n  'provided_text': 'Black metal is a subgenre of heavy metal music.'},\n {'timestamp': '2024-08-22 21:27:45',\n  'query': 'Black metal',\n  'run_id': 'e8432d75142df85bba1f3098403c6023a0f84ec5ef645c7a332c7033a78abcd1',\n  'provided_text': 'Black metals are beautiful and are often used in jewelry design.'}]\n</code></pre> <pre><code>df = comparer.get_all_runs_df()\ndf\n</code></pre> timestamp query run_id provided_text 0 2024-08-22 21:27:45 Black metal 1831f4f4b65bc287d27ff3bdc7bcbb5d9032b2d6b28602... Black metal is an extreme subgenre of heavy me... 1 2024-08-22 21:27:45 Black metal dad65ebf45d7f54284f478e1850d258b8aabb66ba60ff3... Black metal is a subgenre of heavy metal music. 2 2024-08-22 21:27:45 Black metal e8432d75142df85bba1f3098403c6023a0f84ec5ef645c... Black metals are beautiful and are often used ..."},{"location":"usage-examples/#24-comparing-runs-with-records","title":"2.4 Comparing runs with records","text":"<pre><code>comparer.compare_runs_with_records()\n</code></pre> <pre><code>WARNING:ComparisonFrame:No data was found with applied filters!\n</code></pre> <pre><code>comparer.get_all_run_scores()\n</code></pre> <pre><code>[{'timestamp': '2024-08-22 21:27:57',\n  'query': 'Black metal',\n  'run_id': '1831f4f4b65bc287d27ff3bdc7bcbb5d9032b2d6b28602c202514a756eca3223',\n  'provided_text': 'Black metal is an extreme subgenre of heavy metal music.',\n  'record_id': '0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8bd7b663c92f2f16e87',\n  'word_count_diff': 0,\n  'semantic_similarity': 1.0000001192092896,\n  'comparison_id': '25a7dab1af09323799699cd6d28529090072ee0808f1f1a4942c1db69c7b1621'},\n {'timestamp': '2024-08-22 21:27:57',\n  'query': 'Black metal',\n  'run_id': 'dad65ebf45d7f54284f478e1850d258b8aabb66ba60ff31236666a4ede5260cc',\n  'provided_text': 'Black metal is a subgenre of heavy metal music.',\n  'record_id': '0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8bd7b663c92f2f16e87',\n  'word_count_diff': 1,\n  'semantic_similarity': 0.9859851002693176,\n  'comparison_id': '34611011b656a9495178dd833ce09c3afe6b9083abc47f1b42d43e1e76b143a4'},\n {'timestamp': '2024-08-22 21:27:57',\n  'query': 'Black metal',\n  'run_id': 'e8432d75142df85bba1f3098403c6023a0f84ec5ef645c7a332c7033a78abcd1',\n  'provided_text': 'Black metals are beautiful and are often used in jewelry design.',\n  'record_id': '0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8bd7b663c92f2f16e87',\n  'word_count_diff': 1,\n  'semantic_similarity': 0.4940534234046936,\n  'comparison_id': '2fe5604e66d318a8195f4b3a9aa4548894a57972fbcc8386aaea3ee0ef02c071'}]\n</code></pre> <pre><code>comparer.get_all_run_scores_df()\n</code></pre> timestamp query run_id provided_text record_id word_count_diff semantic_similarity comparison_id 0 2024-08-22 21:27:57 Black metal 1831f4f4b65bc287d27ff3bdc7bcbb5d9032b2d6b28602... Black metal is an extreme subgenre of heavy me... 0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8... 0 1.000000 25a7dab1af09323799699cd6d28529090072ee0808f1f1... 1 2024-08-22 21:27:57 Black metal dad65ebf45d7f54284f478e1850d258b8aabb66ba60ff3... Black metal is a subgenre of heavy metal music. 0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8... 1 0.985985 34611011b656a9495178dd833ce09c3afe6b9083abc47f... 2 2024-08-22 21:27:57 Black metal e8432d75142df85bba1f3098403c6023a0f84ec5ef645c... Black metals are beautiful and are often used ... 0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8... 1 0.494053 2fe5604e66d318a8195f4b3a9aa4548894a57972fbcc83..."},{"location":"usage-examples/#3-calculating-aggregate-comparison-scores","title":"3 Calculating aggregate comparison scores","text":"<pre><code>comparer.calculate_aggr_scores()\n</code></pre> <pre><code>WARNING:ComparisonFrame:No data was found with applied filters!\n</code></pre> <pre><code>comparer.get_all_aggr_scores()\n</code></pre> <pre><code>[{'timestamp': '2024-08-22 21:30:40',\n  'comparison_id': ['25a7dab1af09323799699cd6d28529090072ee0808f1f1a4942c1db69c7b1621',\n   '34611011b656a9495178dd833ce09c3afe6b9083abc47f1b42d43e1e76b143a4',\n   '2fe5604e66d318a8195f4b3a9aa4548894a57972fbcc8386aaea3ee0ef02c071'],\n  'query': 'Black metal',\n  'median_word_count_diff': 1.0,\n  'median_semantic_similarity': 0.9859851002693176,\n  'record_status_id': 'd11f7522f4e4e34a6e6f387c6ce7572d43c69fef9f628e63d3f99c93cf0f4f7d'}]\n</code></pre> <pre><code>comparer.get_all_aggr_scores_df()\n</code></pre> timestamp comparison_id query median_word_count_diff median_semantic_similarity record_status_id 0 2024-08-22 21:30:40 [25a7dab1af09323799699cd6d28529090072ee0808f1f... Black metal 1.0 0.985985 d11f7522f4e4e34a6e6f387c6ce7572d43c69fef9f628e..."},{"location":"usage-examples/#4-recording-test-statuses","title":"4. Recording test statuses","text":"<pre><code>comparer.calculate_test_statuses(test_query = \"median_semantic_similarity &gt; 0.9\")\n\n</code></pre> <pre><code>comparer.get_test_statuses()\n</code></pre> <pre><code>[{'timestamp': '2024-08-22 21:31:18',\n  'record_id': '0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8bd7b663c92f2f16e87',\n  'record_status_id': 'd11f7522f4e4e34a6e6f387c6ce7572d43c69fef9f628e63d3f99c93cf0f4f7d',\n  'query': 'Black metal',\n  'valid': True},\n {'timestamp': '2024-08-22 21:31:51',\n  'record_id': '0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8bd7b663c92f2f16e87',\n  'record_status_id': 'd11f7522f4e4e34a6e6f387c6ce7572d43c69fef9f628e63d3f99c93cf0f4f7d',\n  'query': 'Black metal',\n  'valid': True},\n {'timestamp': '2024-08-22 21:36:59',\n  'record_id': '0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8bd7b663c92f2f16e87',\n  'record_status_id': 'd11f7522f4e4e34a6e6f387c6ce7572d43c69fef9f628e63d3f99c93cf0f4f7d',\n  'query': 'Black metal',\n  'valid': False}]\n</code></pre> <pre><code>comparer.get_test_statuses_df()\n</code></pre> timestamp record_id record_status_id query valid 0 2024-08-22 21:31:18 0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8... d11f7522f4e4e34a6e6f387c6ce7572d43c69fef9f628e... Black metal True 1 2024-08-22 21:31:51 0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8... d11f7522f4e4e34a6e6f387c6ce7572d43c69fef9f628e... Black metal True 2 2024-08-22 21:36:59 0cc157453395b440f36d1a1aee24aa76a03f5f9ab0a7a8... d11f7522f4e4e34a6e6f387c6ce7572d43c69fef9f628e... Black metal False"},{"location":"usage-examples/#5-reseting-statuses-flushing-records-and-comparison-results","title":"5. Reseting statuses, flushing records and comparison results","text":"<pre><code>comparer.flush_records()\n</code></pre> <pre><code>comparer.flush_runs()\n</code></pre> <pre><code>comparer.flush_comparison_scores()\n</code></pre> <pre><code>comparer.flush_aggregate_scores()\n</code></pre> <pre><code>comparer.flush_test_statuses()\n</code></pre>"}]}